## ğŸ’¡ ë‹¤ëŒ€ì¼(N:1) ê´€ê³„ë€?
- ë‹¤ëŒ€ì¼ ê´€ê³„ëŠ” **ë§ì€ ë ˆì½”ë“œê°€ ë‹¤ë¥¸ í…Œì´ë¸” í•˜ë‚˜ì˜ ë ˆì½”ë“œì™€ ì—°ê²°ë  ìˆ˜ ìˆëŠ” ê´€ê³„**ì´ë‹¤.
  ![Untitled](https://github.com/roovies/TIL/assets/119032680/10efe6e8-724a-496f-a7b8-d06c55c781fc)

- JPAì—ì„œ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ë©°, ë°˜ë“œì‹œ ì•Œì•„ì•¼ í•œë‹¤.
- ë‹¤ëŒ€ì¼ì˜ ë°˜ëŒ€ëŠ” ì¼ëŒ€ë‹¤ì¸ë°, **ì•ì„œ ì¼ëŒ€ë‹¤ë¥¼ ê³µë¶€í•  ë•Œ ì™¸ë˜í‚¤ê°€ ë°˜ë“œì‹œ ë‹¤ìª½ì— ìˆì–´ì•¼ í•œë‹¤ê³  í–ˆë‹¤.**

<br>
<br>

## ğŸ’¡ ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥ íŠ¹ì§•
![OneToManyImage2](https://github.com/roovies/TIL/assets/119032680/b0095eb1-f009-47ea-9e29-7b2debcac6ae)
- Memberì™€ Teamì€ ë‹¤ëŒ€ì¼(N:1) ê´€ê³„ì´ë‹¤.
- ë‹¤ëŒ€ì¼ ê´€ê³„ì—ì„œ ë‹¤ìª½ ì—”í‹°í‹°(Member)ì—ì„œ ë‹¨ìˆœíˆ ì¼ìª½ ì—”í‹°í‹°(Team)ìœ¼ë¡œ ë‹¨ë°©í–¥ ì°¸ì¡°ë¥¼ í•˜ê³  ì‹¶ìœ¼ë©´, í…Œì´ë¸”ì— ì™¸ë˜í‚¤ê°€ ìˆëŠ” Member ê°ì²´ì—ì„œ Team ê°ì²´ë¡œ ì—°ê´€ê´€ê³„ ë§¤í•‘ì„ í•˜ë©´ ëœë‹¤.
- í…Œì´ë¸”ì—ì„œ ì™¸ë˜í‚¤(FK)ê°€ Teamì„ ì°¾ê¸° ìœ„í•´ ì¡´ì¬í•˜ê³ , ë§ˆì°¬ê°€ì§€ë¡œ Member ê°ì²´ì—ì„œì˜ Team í•„ë“œë„ Teamì„ ì°¸ì¡°í•˜ê¸° ìœ„í•´ ì¡´ì¬í•œë‹¤.
- **ë”°ë¼ì„œ DB ì„¤ê³„ìƒ ë°˜ë“œì‹œ ì¼ëŒ€ë‹¤ì—ì„œ ë‹¤ìª½ì— ì™¸ë˜í‚¤ê°€ ì¡´ì¬í•´ì•¼ í•œë‹¤.** ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì˜ëª»ëœ ì„¤ê³„ë‹¤.

<br>
<br>

## ğŸ’¡ ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥ ë§¤í•‘
- JPAì—ì„œëŠ” `@ManyToOne` ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ ë‹¤ëŒ€ì¼ ê´€ê³„ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.
- `@JoinColumn`ì€ ì™¸ë˜í‚¤ë¥¼ ë§¤í•‘í•  ë•Œ ì‚¬ìš©í•œë‹¤. **nameì€ í…Œì´ë¸” ì»¬ëŸ¼ ì¤‘ ë§¤í•‘í•  ì™¸ë˜í‚¤ ì´ë¦„**ì´ë‹¤.
```java
public class Member {
...
   @ManyToOne
   @JoinColumn(name = "team_id")
   private Team team;
...
}
```

<br>
<br>

## ğŸ’¡ ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ ë§¤í•‘
- ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ ë§¤í•‘ì€ **ë‹¨ë°©í–¥ì„ ë¨¼ì € ì§„í–‰í•˜ê³ , ë°˜ëŒ€ìª½ì—ì„œ ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ ë§¤í•‘ì„ í•´ì£¼ë©´ ëœë‹¤.**
    - ì•ì„œ ì–˜ê¸°í–ˆë“¯ì´, ì™¸ë˜í‚¤ ê´€ë¦¬ëŠ” ë‹¤ìª½ì—ì„œ í•˜ê¸° ë•Œë¬¸ì— `@JoinColumn`ì€ ë‹¤ìª½ì—ë§Œ ì¡´ì¬í•œë‹¤.
- ë‹¤ìª½ì—ì„œ ì´ë¯¸ ì—°ê´€ê´€ê³„ ì£¼ì¸ì´ ë˜ì–´ì„œ ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•˜ê³  ìˆê¸° ë•Œë¬¸ì— DB í…Œì´ë¸”ì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.
- JPAì—ì„œëŠ” `@OneToMany` ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ ë°˜ëŒ€ìª½ ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ ë§¤í•‘ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.
    - **ì¦‰, ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥(ì™¸ë˜í‚¤ ê´€ë¦¬) + ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ = ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥**

```java
public class Team {
  ...
   @OneToMany(mappedBy = "team")
   private List<Member> members = new ArrayList<>();
  ...
}
```

- ì´ë•Œ, ì¼ìª½ ì—”í‹°í‹°(Team)ì€ ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ì•„ë‹ˆë‹¤.
- ë”°ë¼ì„œ ë‚´ ì£¼ì¸ì´ ëˆ„êµ¬ì¸ì§€, ì¦‰ ì–´ë””ì— ë§¤í•‘ ëëŠ”ì§€ì— ê´€í•œ ì •ë³´ë¥¼ mappedBy ì†ì„±ì„ í†µí•´ ì •ì˜í•´ì¤˜ì•¼ í•œë‹¤.
- **(mappedBy = "team")** ì´ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ” Teamì˜ memers í•„ë“œê°€ Member ì—”í‹°í‹°ì˜ team í•„ë“œì— ë§¤í•‘ ë˜ì—ˆë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

<br>
<br>

### ğŸ“Œ ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ì„ ì‚¬ìš©í•˜ì—¬ ì‹¤ì œ  ì¿¼ë¦¬ë¬¸ì´ ì–´ë–»ê²Œ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ì.
1. Memberì™€ Teamì€ ë‹¤ëŒ€ì¼ ê´€ê³„ì´ë©°, ì—”í‹°í‹°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

    ```java
    // Member ì—”í‹°í‹°
    @Entity
    public class Member {
    ...
       @ManyToOne
       @JoinColumn(name = "TEAM_ID")
       private Team team;
    ...
    }
    
    // Team ì—”í‹°í‹°
    @Entity
    public class Team {
      ...
       @OneToMany(mappedBy = "team")
       private List<Member> members = new ArrayList<>();
      ...
    }
    ```

2. ì´ë•Œ ë‹¤ìŒê³¼ ê°™ì´ TEAMì— Memberë¥¼ ì¶”ê°€í•œ í›„ DBì— ì €ì¥í•˜ê²Œ ë˜ë©´,
    ```java
    Team team = new Team();
    team.setName("TEAM1");
    em.persist(team);
    System.out.println("====íŒ€ ì €ì¥====\n");
    
    Member member = new Member();
    member.setUsername("roovies");
    member.changeTeam(team);
    em.persist(member);
    System.out.println("===ë©¤ë²„ ì €ì¥====\n");
    
    tx.commit();
    ```

3. í•„ìš”í•œ ì¿¼ë¦¬ë¬¸ë§Œ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
    ```java
    Hibernate:
       /* insert hello.jpa.Team
           */
           insert
           into
              Team
              (id, name)
           values
              (null, ?)
    ====íŒ€ ì €ì¥====
    
    Hibernate:
       /* insert hello.jpa.Member
           */
           insert
           into
              Member
              (id, age, createdDate, description, lastModifiedDate, roleType, TEAM_ID, name)
           values
              (null, ?, ?, ?, ?, ?, ?, ?)
    ====ë©¤ë²„ ì €ì¥====
    ```
    - ì´ì „ì— ì¼ëŒ€ë‹¤ ê´€ê³„ì— ì™¸ë˜í‚¤ë¥¼ ì„¤ì •í–ˆì„ ë•, updateê°€ ì¶”ê°€ì ìœ¼ë¡œ ë°œìƒí–ˆì—ˆë‹¤.
    - ê·¸ë¦¬ê³  ê·¸ê±¸ êµ³ì´ ì¼ëŒ€ë‹¤ì—ì„œ í•´ê²°í•˜ê² ë‹¤ í•˜ë©´, @JoinColumnì— ì œì•½ì¡°ê±´ìœ¼ë¡œ updatable, instertableì„ FALSEë¡œ ì„¤ì •í–ˆì—ˆë‹¤.
    - ì´ê²Œ ì–¼ë§ˆë‚˜ ê·€ì°®ì€ ì¼ì¸ê°€?
    - ê·¸ëŸ¬ë‚˜ ì´ë ‡ê²Œ ë‹¤ëŒ€ì¼ì—ì„œ ë‹¤ìª½ì´ ì£¼ì¸ì¼ ê²½ìš° ë„ˆë¬´ë„ ëª…í™•í•˜ê³  ì‰½ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

<br>
<br>

## ğŸ“Œ ê²°ë¡ 
> ë‹¤ëŒ€ì¼ì˜ ë°˜ëŒ€ëŠ” ì¼ëŒ€ë‹¤ì´ë‹¤.
> 
> ë‹¤ëŒ€ì¼ì´ë“  ì¼ëŒ€ë‹¤ë“  **ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ì£¼ì¸ì€ í•­ìƒ â€˜ë‹¤â€™ìª½ì— ìˆì–´ì•¼ í•œë‹¤.**
> 
> **ì¼ëŒ€ë‹¤ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ë©´, ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ì„ êµ¬ì¶•í•´ì„œ ì‚¬ìš©í•œë‹¤.**

<br>

### âœ ManyToOne ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš© ì˜ˆì‹œ
```java
@Entity
@Table(name = "user")
//ê·¸ ì™¸ í•„ìš” ì–´ë…¸í…Œì´ì…˜ë“¤ ìƒëµ
public class Posting {
    @Id
		@GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
		
		@ManyToOne
		@JoinColumn(name = "user_id")
		private User user;

		@Column(name = "title")
		@NotNull
		private String title;

		@Column(name = "content")
		@NotNull
		private String content;
}
```