## ğŸ’¡ ì¼ëŒ€ë‹¤(1:N) ê´€ê³„ë€?
- ì¼ëŒ€ë‹¤ ê´€ê³„ëŠ” <span style='color: #D44C47;'>**í•œ ê°œì˜ ë ˆì½”ë“œê°€ ë‹¤ë¥¸ í…Œì´ë¸” ì—¬ëŸ¬ ê°œì˜ ë ˆì½”ë“œì™€ ì—°ê²°ë  ìˆ˜ ìˆëŠ” ê´€ê³„**</span>ì´ë‹¤.

  ![OneToManyImage1](https://github.com/roovies/TIL/assets/119032680/1736c9bf-545a-4795-a0a9-fd68d28353fa)

- **ì¼ëŒ€ë‹¤** ê´€ê³„ì—ì„œëŠ” **ì¼ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸**ì´ ëœë‹¤.
    - ì¦‰, **ì¼ìª½ì—ì„œ ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬**í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.
- JPAì—ì„œëŠ” `@OneToMany` ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ 1:N ê´€ê³„ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

<br>
<br>

## ğŸ’¡ ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ íŠ¹ì§•
![OneToManyImage2](https://github.com/roovies/TIL/assets/119032680/b0095eb1-f009-47ea-9e29-7b2debcac6ae)
- Teamê³¼ MemberëŠ” ì¼ëŒ€ë‹¤(1:N) ê´€ê³„ì´ë‹¤.
- Team ì—”í‹°í‹°ëŠ” Member ëª©ë¡ì¸ Membersë¥¼ ê°€ì§€ê²Œ ë˜ëŠ”ë°,
  Member ì…ì¥ì—ì„œëŠ” Teamì„ ì°¸ì¡°í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ë¼ëŠ” ì„¤ê³„ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆë‹¤.
- ê·¸ëŸ¬ë‚˜, **DB í…Œì´ë¸” ì…ì¥ì—ì„œ ë³´ë©´, ë¬´ì¡°ê±´ ì¼ëŒ€ë‹¤ì˜ ë‹¤ìª½ì— ì™¸ë˜í‚¤ê°€ ë“¤ì–´ê°„ë‹¤.**
- Teamì—ì„œ membersê°€ ë°”ë€Œë©´, DBì˜ Member í…Œì´ë¸”ì— ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ê°€ ë‚˜ê°€ê²Œ ëœë‹¤.

<br>
<br>

## ğŸ’¥ ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ì˜ ë¬¸ì œì 
> **Teamì—ì„œ membersê°€ ë°”ë€Œë©´, DBì˜ Member í…Œì´ë¸”ì— ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ê°€ ë°œìƒí•˜ê²Œ ëœë‹¤.**
1. Member ì—”í‹°í‹°ì—ëŠ” ì—°ê´€ê´€ê³„ê°€ ì•„ì˜ˆ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šê³ , Team ì—”í‹°í‹°ì—ì„œë§Œ ì¼ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì„¤ì •í•˜ì—¬ ë‹¨ë°©í–¥ ë§¤í•‘ì¸ ìƒíƒœ
    ```java
    @Entity
    public class Team {
      ...
       @OneToMany
       @JoinColumn(name = "team_id")
       private List<Member> members = new ArrayList<>();
      ...
    }
    ```

2. ì´ë•Œ ë‹¤ìŒê³¼ ê°™ì´ TEAMì— Memberë¥¼ ì¶”ê°€í•œ í›„ DBì— ì €ì¥í•˜ê²Œ ë˜ë©´,
    ```java
    ...
    Member member = new Member();
    member.setUsername("roovies");
    em.persist(member);
    
    System.out.println("====ë©¤ë²„ ì €ì¥ ì™„ë£Œ====\n");
    
    Team team = new Team();
    team.setName("TEAM1");
    team.getMembers().add(member);
    em.persist(team);
    
    System.out.println("====íŒ€ ì €ì¥ ì™„ë£Œ====\n");
    
    tx.commit();
    ```

3. ë©¤ë²„ ì €ì¥, íŒ€ ì €ì¥ ì¿¼ë¦¬ë¬¸ ì´ì™¸ì— Member í…Œì´ë¸”ì„ ì—…ë°ì´íŠ¸ í•˜ëŠ” ì¿¼ë¦¬ê°€ ì¶”ê°€ë¡œ ë°œìƒí•œë‹¤.
    ```
    Hibernate:
       /* insert hello.jpa.Member
           */
           insert
           into
              Member
              (id, age, createdDate, description, lastModifiedDate, roleType, name)
           values
              (null, ?, ?, ?, ?, ?, ?)
    ====ë©¤ë²„ ì €ì¥ ì™„ë£Œ====
    
    Hibernate:
       /* insert hello.jpa.Team
           */
           insert
           into
              Team
              (id, name)
           values
              (null, ?)
    ====íŒ€ ì €ì¥ ì™„ë£Œ====
    
    Hibernate:
       /* create one-to-many row hello.jpa.Team.members */
       update
          Member
       set
          TEAM_ID=?
       where
          id=?
    ```

<br>
<br>

## ğŸ’¥ ì¼ëŒ€ë‹¤ ì–‘ë°©í–¥ì˜ ë¬¸ì œì 
- ì‚¬ì‹¤ ì¼ëŒ€ë‹¤ ì–‘ë°©í–¥ ë§¤í•‘ì€ ê³µì‹ì ìœ¼ë¡œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥ ë§¤í•‘ì„ ìˆ˜í–‰í•œ í›„ì— ì¼ìª½ì—ë‹¤ê°€ë„ ì™¸ë˜í‚¤(JoinColumn)ë¥¼ ì„ ì–¸í•˜ëŠ” ê²ƒì´ë‹¤.
    ```java
    @Entity
    public class Member {
    ...
     @ManyToOne
     @JoinColumn(name = "team_id", insertable = false, updatable = false)
     private Team team;
    ...
    }
    
    @Entity
    public class Team {
      ...
       @OneToMany
       @JoinColumn(name = "team_id")
       private List<Member> members = new ArrayList<>();
      ...
    }
    ```
- ìœ„ì²˜ëŸ¼ ì¼ëŒ€ë‹¤ ì–‘ë°©í–¥ì„ êµ¬í˜„í•  ê²½ìš°, Memberì™€ Team ì—”í‹°í‹°ì—ì„œ ëª¨ë‘ í…Œì´ë¸”ì˜ FKí‚¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•œë‹¤.
    - ì´ê±¸ ë§‰ê¸° ìœ„í•´ì„œ insertable, updatable ì„¤ì •ì„ FALSEë¡œ í•˜ì—¬ ì½ê¸° ì „ìš© í•„ë“œë¡œ ì‚¬ìš©í•œë‹¤.

      `@JoinColumn(name = "team_id", insertable = false, updatable = false)`

<br>
<br>

## ğŸ“Œ ê²°ë¡ 
> **ê²°ë¡ ì€ ì´ëŸ° ì‹ìœ¼ë¡œ <span style='color: #D44C47;'>ì¼ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ë©´, ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ì„ í†µí•´ ì‚¬ìš©í•˜ì.</span>**

<br>

### âœ ì˜¬ë°”ë¥¸ @OneToMany ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš© ì˜ˆì‹œ
- <span style='color: #D44C47;'>ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ìœ¼ë¡œì¨ ì‚¬ìš©í•˜ë„ë¡ í•œë‹¤.</span>
- JPAì—ì„œ ì¼ëŒ€ë‹¤(1:N) ê´€ê³„ë¥¼ ì„¤ì •í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.
    - ìœ„ì— ë‚´ìš©ì²˜ëŸ¼ ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
- ë”°ë¼ì„œ ë°˜ë“œì‹œ ë‹¤ìª½ ì—”í‹°í‹°ì—ëŠ” ì¼ìª½ ì—”í‹°í‹°ë¥¼ ì°¸ì¡°í•˜ëŠ” í•„ë“œë¥¼ ê°€ì ¸ê³  ìˆì–´ì•¼ í•œë‹¤.

  â‡’ ì¦‰, ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥ì´ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•¨.

- ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥ìœ¼ë¡œ ì°¸ì¡°ë˜ê³  ìˆìœ¼ë¯€ë¡œ, ì°¸ì¡°ë˜ê³  ìˆëŠ” í•„ë“œëª…ì„
  @OneToMany ì–´ë…¸í…Œì´ì…˜ì— mappedby ì†ì„±ì„ í†µí•´ ì •ì˜í•´ì¤€ë‹¤.
    ```java
    @Entity
    public class Member {
    ...
     @ManyToOne
     @JoinColumn(name = "team_id")
     private Team team;
    ...
    }
    
    @Entity
    public class Team {
      ...
       @OneToMany(mappedby = "team")
       private List<Member> members = new ArrayList<>();
      ...
    }
    ```

- **(mappedBy="team")**ì´ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ” Teamì˜ members í•„ë“œê°€ Member ì—”í‹°í‹°ì˜ team í•„ë“œì— ì˜í•´ ë§¤í•‘ ë˜ì–´ì¡Œë‹¤ëŠ” ê²ƒì´ë‹¤.
- `FetchType.Lazy` ë˜ëŠ” `FetchType.EAGER`ì„ í†µí•´ ë¡œë”© ì „ëµì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.
  OneToManyì˜ ê¸°ë³¸ ë¡œë”© ì „ëµì€ Lazyì´ë‹¤.